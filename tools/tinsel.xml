<tool id="tinsel" name="Export data to magpie" version="0.2.0">
  <description>for interactive analysis, visualization, and annotation with R and markdown</description>
  <version_command>tinsel.py --version</version_command>
  <command interpreter="python">tinsel.py -u ${config} &gt; ${output}</command>
  <!-- TODO check scontrol to see if shiny is running; if not, start it, and request the same node -->
  <inputs>
    <param name="interactive" type="boolean" truevalue="true" falsevalue="false" label="Interactive"/>
    <repeat name="exports" title="Dataset to export">
      <param name="input" type="data" label="Dataset"/>
      <param name="r_name" type="text" size="32" value="my.dataset" label="R variable name" help="From the R documentation for make.names, 'A syntactically valid name consists of letters, numbers and the dot or underline characters and starts with a letter or the dot not followed by a number.'"/>
    </repeat>
  </inputs>
  <outputs>
    <data format="magpie" name="output" label="magpie package"/>
  </outputs>
  <configfiles>
    <!--
         tinsel cell file aped from IPython's notebook format.
         http://ipython.org/ipython-doc/1/interactive/nbconvert.html
    -->
    <configfile name="config">
<![CDATA[
{
  "metadata": {
    "interactive": "${interactive}"
  },
  "cells": [
#for $i, $s in enumerate($exports)
    {
  #if $s.input.ext=="ribbon"
      "cell_type": "ribbon",
      "input": "${s.input.file_name}",
      "metadata": {}
  #else
      "cell_type": "dataset",
      "input": "${s.input.file_name}",
      "metadata": {
        "r_name": "${s.r_name}",
        "format": "${s.input.ext}"
      }
  #end if
  #if $i < len($exports) - 1 then '},' else '}'#
#end for
 ]
}
]]>
    </configfile>
  </configfiles>
  <help>

.. class:: infomark

**What it does**

``magpie`` is an interactive analysis and visualization application
with R and markdown support built with Shiny.

  </help>
</tool>
