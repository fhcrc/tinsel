# On-demand Rmd notebooks

This interactive Rmd notebook is running as a [Shiny][1] application
in R on a gizmo node that was snagged with grabcpu.

Hint: Change things! Use F4 to recompile.

## Loading data from silo

Since R is running on a gizmo node, we've got access to silo. This is
pretty neat, since that also means we have access to Galaxy output.

```{r }
## This is where our files live.
database <- "/shared/silo_researcher/Matsen_F/MatsenGrp/data/galaxy-shapley/database"

##
## Eventually stuff like this will be automated into boilerplate by Galaxy:
##

## "[Genus] Grouped-by-specimen classification (CSV)",csv,84726a17127220c7
by.specimen <- read.csv(file.path(database, "/files/004/dataset_4880.dat"),
                        header=TRUE, as.is=TRUE)

## "1.TCA.454Reads.1000.fasta",fasta,2a0d57490303b027
library(seqinr)
reads <- read.fasta(file.path(database, "files/001/dataset_1351.dat"))

##
## But first there needs to be a little glue layer in between that
## knows how to load various kinds of data into R, which is in
## progress.
##
```

Let's check that our data is there.

```{r }
head(by.specimen)
```

```{r }
str(reads[1])
```

Yay!

## Doing things

Now we can do whatever we want with our data (CSV, FASTA, BAM, ...
anything R can be made to understand). Like make pretty but useless
pictures!

```{r , fig.height=9, fig.width=16}
library(ggplot2)
ggplot(subset(by.specimen, tax_name=="Lactobacillus")[1:20,], aes(x=specimen, y=placements)) +
  geom_point(aes(color=placements, size=tally))
```

For tools like Martin and Dan's, this makes a lot more sense than the
standard submit-and-wait Galaxy experience. They can write gorgeous
analyses in Rmd, have access to the pipeline outputs, and either

1. Use Shiny's [gorgeous interface][7] to make dynamic reports;
   or
1. Show a page like this and have a little playground to tweak
   settings or play with the data.

And go click that link if you didn't. At least look at [this one][8].

## And more cool stuff!

In addition to presenting an editor, Shiny can also fetch text to
render from other sources:

* [runGist][2] -- Run a Shiny application from https://gist.github.com
* [runGitHub][3] -- Run a Shiny application from a GitHub repository
* [runUrl][4] -- Run a Shiny application from a URL

There's also a [Shiny server][5] capable of handling more requests,
available in both open-source and proprietary flavors, and hosting
available at [ShinyApps.io][6].

Et voila! :)

[1]: http://shiny.rstudio.com/
[2]: http://shiny.rstudio.com/reference/shiny/latest/runGist.html
[3]: http://shiny.rstudio.com/reference/shiny/latest/runGitHub.html
[4]: http://shiny.rstudio.com/reference/shiny/latest/runUrl.html
[5]: http://shiny.rstudio.com/deploy/
[6]: http://www.rstudio.com/shiny/hosted/
[7]: http://shiny.rstudio.com/gallery/
[8]: http://shiny.rstudio.com/gallery/movie-explorer.html
