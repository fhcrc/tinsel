<tool id="tinsel" name="Export data to magpie" version="1.0.0">
  <description>for interactive analysis, visualization, and annotation with R and markdown</description>
  <version_command>echo "magpie 1.0.0"</version_command>
  <command>cp -f ${payload} ${output}</command>
  <!-- TODO check scontrol to see if shiny is running; if not, start it, and request the same node -->
  <inputs>
    <repeat name="exports" title="Datasets to export">
      <param name="input" type="data" label="Dataset"/>
      <param name="r_name" type="text" size="32" value="my.dataset" label="R variable name" help="From the R documentation for make.names, 'A syntactically valid name consists of letters, numbers and the dot or underline characters and starts with a letter or the dot not followed by a number.'"/>
    </repeat>
  </inputs>
  <outputs>
    <data format="magpie" name="output" label="magpie package"/>
  </outputs>
  <configfiles>
    <!-- TODO can this be CDATA? -->
    <configfile name="payload">
#raw
```{r magpie, echo=FALSE}
## magpie begin

#end raw
#for $i, $s in enumerate($exports)
\#\# TODO Add comment with &quot;Dataset name&quot;,&quot;API key,&quot;,...
${s.r_name} &lt;- read.csv(&quot;${s.input.file_name}&quot;, as.is=TRUE)

#end for
#raw

## magpie end
```

#end raw
    </configfile>
  </configfiles>
  <help>

.. class:: infomark

**What it does**

``magpie`` is an interactive analysis and visualization application
with R and markdown support built with Shiny.

  </help>
</tool>
